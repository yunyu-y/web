<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <div>
        <span>身分證檢查:</span>
        <input type="text">
        <button>檢查</button>
    </div>
    <script>
        var input
        function isIdNo() {
            var letter = input.value.charCodeAt(0)
            if (input.value.length != 10) {
                return false
            }
            if (letter < 65 || letter > 90) {
                return false
            }
            if (input.value.charAt(1) != 1 && input.value.charAt(1) != 2) {
                return false
            }

            if (letter == 73) {
                letter = 34
            } else {

            }

            switch (letter) {
                case 73:
                    letter = 34
                    break;
                case 79:
                    letter = 35
                    break;
                case 87:
                    letter = 32
                    break;
                case 90:
                    letter = 33
                    break;
                default:
                    if (letter <= 72) {
                        letter -= 55
                    } else if (letter <= 78) {
                        letter -= 56
                    } else if (letter <= 86) {
                        letter -= 57
                    } else {
                        letter -= 58
                    }
                    break;
            }

            var letter_num = (letter % 10) * 9 + Math.floor(letter / 10)
            var no_num = 0
            var j = 8
            for (let i = 1; i <= 8; i++) {
                no_num = no_num + input.value.charAt(i) * j
                j--
            }


            var check_num = 10 - (letter_num + no_num) % 10
            if (check_num == 10) {
                check_num = 0
            }
            console.log(check_num)

            if (input.value.charAt(9) != check_num) {
                return false
            }
            return true
        }

        function check() {
            if (isIdNo() == false) {
                window.alert("Error!")
            } else {
                window.alert("OK!")
            }
        }

        function init() {
            input = document.getElementsByTagName('input')[0]
            document.getElementsByTagName('button')[0].onclick = isIdNo
            document.getElementsByTagName('button')[0].onclick = check
        }
        window.onload = init
    </script>
</body>

</html>